# 使用教程

## 日常使用

- `搜图关键词` (`search_keyword`) 可以自定义，默认为 `搜图` ；之所以叫做关键词而不是指令，是因为它可以不在消息开头
- 如果想让机器人只响应含有 `搜图关键词` 的消息 (优先级高于 `search_immediately`) ，启用 `search_keyword_only`
- 私聊：
    - 发送 `搜图关键词` 及参数进入搜图模式，详见下方的 [搜图模式](#搜图模式)
    - 直接发送图片 (如果禁用了 `search_immediately` ，需要先发送 `搜图关键词` 进入搜图模式)
    - 回复自己或机器人发送的图片，在消息中附上 `搜图关键词` 及参数 (如果回复的是机器人，必须带上 `搜图关键词` 才会搜图，否则会被无视)
- 群聊：
    - 发送 `搜图关键词` 及参数进入搜图模式，详见下方的 `搜图模式`
    - `@机器人` 并发送图片
    - 回复某人 (包括自己) 发送的图片，在消息中附上 `搜图关键词` 或 `@机器人` 及参数 (如果回复的是机器人，必须带上 `搜图关键词` 才会搜图，否则会被无视)
- 可以在同一条消息中包含多张图片，会自动批量搜索
- 搜索图片时可以在消息内包含以下参数来指定搜索范围或者使用某项功能，优先级 (除去 `--purge`) 从上到下：
    - `--all` 全库搜索 (默认)
    - `--pixiv` 从 Pixiv 中搜索
    - `--danbooru` 从 Danbooru 中搜索
    - `--doujin` 搜索本子
    - `--anime` 搜索番剧
    - `--a2d` 使用 Ascii2D 进行搜索 (优势搜索局部图能力较强)
    - `--baidu` 使用 Baidu 进行搜索
    - `--ex` 使用 ExHentai (E-Hentai) 进行搜索
    - `--google` 使用 Google 进行搜索
    - `--iqdb` 使用 Iqdb 进行搜索
    - `--yandex` 使用 Yandex 进行搜索
    - `--purge` 无视缓存进行搜图，并更新缓存
- 对于 SauceNAO：
    - 如果得到的结果相似度低于 60% (可配置)，会自动使用 Ascii2D 进行搜索 (可配置)
    - 如果额度耗尽，会自动使用 Ascii2D 进行搜索
    - 如果搜索到本子，会自动在 ExHentai (E-Hentai) 中搜索并返回链接 (如果有汉化本会优先返回汉化本链接)
    - 如果搜到番剧，会自动使用 WhatAnime 搜索番剧详细信息：
        - AnimeDB 与 WhatAnime 的结果可能会不一致，是正常现象，毕竟这是两个不同的搜索引擎
        - 同时展示这两个搜索的目的是为了尽力得到你可能想要的识别结果
- 对于 ExHentai：
    - 如果没有配置 `EXHENTAI_COOKIES` ，会自动使用 `E-Hentai` 搜索 (如何获取 cookies 请参考 [PicImageSearch 文档](https://pic-image-search.kituin.fun/wiki/picimagesearch/E-hentai/DataStructure/#cookies%E8%8E%B7%E5%8F%96))
    - 不支持单色图片的搜索，例如黑白漫画，只推荐用于搜索 CG 、画集、图集、彩色漫画、彩色封面等
    - 如果没有配置 `superusers` ，不会显示搜索结果的收藏状态
- 关于进行搜索后未收到机器人回复的新消息的情况：  
  这可能是因为消息中包含的链接被列入黑名单，成了所谓的 `红链`。需通过查阅 gocqhttp 或其他上游端的日志，来确定哪个网站的域名被封禁了，然后参照 `config.py` 文件配置相应的配置项 `to_confuse_urls` 来规避。

## 搜图模式

搜图模式存在的意义是方便手机用户在转发图片等不方便在消息中夹带 @ 或搜图参数的情况下指定搜索范围或者使用某项功能：

- 发送 `搜图关键词` 并附上搜索范围或者功能参数，如果没有指定，会使用默认设置 (即 `--all`)
- 此时你发出来的下一条消息中的图 (也就是一次性的) 会使用指定搜索范围或者使用某项功能
